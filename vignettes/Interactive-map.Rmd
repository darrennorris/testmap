---
title: "Interactive map"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Interactive-map}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(testmap)
```


```{r load-packages, echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(leaflet)
library(sf)
```

Use the interactive map to check population changes.
```{r make-map}
orinoco <- points_bau |> 
  filter(BASIN_N == "Orinoco") |> st_as_sf() |> st_transform(4326)
orinocolow <- orinoco
# colour palette
pal <- colorFactor(
  palette = c("#7274C1", "#A3720E"),
  domain = orinoco$flag_50_42y
)
 
# interactive map
leaflet::leaflet(data = orinoco) |> 
  addTiles() |>
  addCircleMarkers(color = ~pal(flag_50_42y), 
             stroke = FALSE, fillOpacity = 0.4, 
clusterOptions = markerClusterOptions(), 
group = "orinoco"
) |>                        
  groupOptions("orinoco", zoomLevels = 1:10) |> 
  addCircles(data = orinocolow, 
             color = ~pal(flag_50_42y), 
group = "orinocolow"
) |>                        
  groupOptions("orinocolow", zoomLevels = 11:15)

  
```

